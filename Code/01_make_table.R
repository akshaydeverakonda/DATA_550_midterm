here::i_am("Code/01_make_table.R")

wastewater_data_filtered <- readRDS(
  file = here::here("Output/data_clean.rds")
)

library(dplyr)

# Group by state and calculate the average change in "ptc_15d" per state
avg_change_per_state <- wastewater_data_filtered %>%
  group_by(wwtp_jurisdiction) %>%
  summarise(avg_change_ptc_15d = mean(ptc_15d, na.rm = TRUE))

# Rename columns for clarity
colnames(avg_change_per_state) <- c("State", "Average_Change_in_ptc_15d")

saveRDS(
  avg_change_per_state,
  file = here::here("Output/table.rds")
)